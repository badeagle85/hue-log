---
// Giscus 댓글 시스템
// GitHub Discussions를 사용하는 댓글 시스템
// 설정: https://giscus.app 에서 설정 필요
---

<div class="giscus-container">
  <script
    src="https://giscus.app/client.js"
    data-repo="badeagle85/hue-log"
    data-repo-id="YOUR_REPO_ID"
    data-category="Announcements"
    data-category-id="YOUR_CATEGORY_ID"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="ko"
    data-loading="lazy"
    crossorigin="anonymous"
    async
  ></script>
</div>

<style>
  .giscus-container {
    margin-top: 3rem;
    padding-top: 3rem;
    border-top: 1px solid var(--gray-200);
  }
</style>

<script>
  // 다크모드 테마 동기화
  function updateGiscusTheme() {
    const theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    const iframe = document.querySelector<HTMLIFrameElement>('iframe.giscus-frame');
    if (iframe) {
      iframe.contentWindow?.postMessage(
        {
          giscus: {
            setConfig: {
              theme: theme === 'dark' ? 'dark_dimmed' : 'light',
            },
          },
        },
        'https://giscus.app'
      );
    }
  }

  // MutationObserver로 다크모드 변경 감지
  const observer = new MutationObserver(() => {
    updateGiscusTheme();
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['class'],
  });

  // 초기 테마 설정
  document.addEventListener('DOMContentLoaded', updateGiscusTheme);
</script>